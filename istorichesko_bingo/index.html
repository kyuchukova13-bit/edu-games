<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BINGO - –ò—Å—Ç–æ—Ä–∏—è 3. –ö–ª–∞—Å - –î. –ö—é—á—É–∫–æ–≤–∞</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            --gold-ball: radial-gradient(circle at 15px 15px, #f1c40f, #d35400);
            --accent-red: #c0392b;
        }

        body, html {
            margin: 0; padding: 0; min-height: 100vh;
            font-family: 'Arial Black', Gadget, sans-serif;
            background: #1a2a6c; 
            color: white;
        }

        /* –ù–ê–ß–ê–õ–ï–ù –ï–ö–†–ê–ù */
        #intro-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-gradient);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 500; transition: opacity 0.5s; text-align: center; padding: 20px;
            box-sizing: border-box;
        }
        #intro-screen h1 { font-size: 65px; text-shadow: 4px 4px 10px rgba(0,0,0,0.5); margin-bottom: 10px; }
        .author-name-intro { font-size: 30px; color: #fdbb2d; margin-bottom: 25px; }
        
        .instructions-intro { 
            font-size: 21px; line-height: 1.5; max-width: 800px; 
            background: rgba(0,0,0,0.3); padding: 35px; border-radius: 20px; margin-bottom: 40px;
            font-family: 'Segoe UI', sans-serif; text-align: left;
        }

        .btn-group { display: flex; gap: 20px; }

        #start-btn, #open-generator-btn { 
            padding: 20px 60px; font-size: 28px; cursor: pointer; 
            border: none; border-radius: 50px; 
            font-weight: bold; box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        #start-btn { background: white; color: #b21f1f; }
        #open-generator-btn { background: #fdbb2d; color: #333; }
        #start-btn:hover, #open-generator-btn:hover { transform: scale(1.05); }

        /* –û–°–ù–û–í–ï–ù –õ–ï–ô–ê–£–¢ –ò–ì–†–ê */
        .main-container {
            display: none; height: 100vh; width: 100vw;
            align-items: center; justify-content: space-around; padding: 20px; box-sizing: border-box;
        }

        .sphere-section { flex: 1.2; display: flex; flex-direction: column; align-items: center; }
        #lotto-sphere {
            position: relative; width: 480px; height: 480px;
            background: rgba(255,255,255,0.05); border: 12px solid rgba(255,255,255,0.2);
            border-radius: 50%; overflow: hidden; box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
        }

        .ball {
            position: absolute; width: 52px; height: 52px;
            background: var(--gold-ball); border-radius: 50%;
            color: white; font-weight: bold; font-size: 20px;
            display: flex; align-items: center; justify-content: center;
        }

        #check-btn { 
            margin-top: 15px; padding: 10px 25px; background: none; border: 1px solid rgba(255,255,255,0.4); 
            color: white; border-radius: 5px; cursor: pointer; font-family: sans-serif; font-size: 14px;
        }

        .answer-section { flex: 1; display: flex; flex-direction: column; align-items: center; }
        #bingo-title { font-size: 100px; margin: 0; color: #fdbb2d; letter-spacing: 15px; text-shadow: 2px 2px 10px rgba(0,0,0,0.5); }

        .flip-card {
            width: 95%; height: 380px; position: relative;
            transform-style: preserve-3d; transition: transform 0.8s;
            margin: 20px 0; 
        }
        .is-flipped { transform: rotateX(180deg); }

        .card-face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 40px;
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; box-sizing: border-box;
        }
        .card-front { background: rgba(255,255,255,0.08); border: 4px dashed rgba(255,255,255,0.2); }
        .card-back { background: white; transform: rotateX(180deg); border: 10px solid #f1c40f; color: #1a2a6c; }

        #result-ball {
            width: 100px; height: 100px; background: var(--gold-ball);
            border-radius: 50%; color: white; font-size: 50px;
            display: flex; align-items: center; justify-content: center; margin-bottom: 15px; border: 4px solid #fff;
        }
        #riddle-text { font-size: 38px; text-align: center; margin: 0; font-weight: bold; line-height: 1.2; font-family: 'Segoe UI', sans-serif; }

        #draw-btn {
            padding: 20px 80px; font-size: 35px;
            background: var(--accent-red); color: white; border: 4px solid #fdbb2d; 
            border-radius: 100px; cursor: pointer; font-weight: bold;
            box-shadow: 0 8px #922b21;
        }

        /* –ï–ö–†–ê–ù –ó–ê –ü–†–û–í–ï–†–ö–ê */
        #check-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 600;
            display: none; flex-direction: column; align-items: center; padding: 40px;
        }
        #check-log {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px; width: 90%; overflow-y: auto; margin-top: 30px;
        }
        .log-item { background: white; color: #333; padding: 12px; border-radius: 8px; font-size: 18px; border-left: 10px solid #f1c40f; font-family: sans-serif; text-align: left;}

        /* –°–¢–ò–õ–û–í–ï –ó–ê –ì–ï–ù–ï–†–ê–¢–û–†–ê –ù–ê –ö–ê–†–¢–ò */
        #generator-section { display: none; background: #f0f0f0; color: #333; padding: 20px; text-align: center; overflow-y: auto; }
        .gen-controls { background: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .page { width: 21cm; min-height: 29.7cm; padding: 1cm; margin: 0 auto 1cm auto; background: white; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .ticket { width: 18cm; height: 12.5cm; border: 4px solid #333; border-radius: 15px; margin-bottom: 1.5cm; padding: 20px; box-sizing: border-box; background: #fff; display: flex; flex-direction: column; }
        .ticket-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #b21f1f; margin-bottom: 15px; }
        .ticket-title { font-size: 42px; color: #b21f1f; margin: 0; }
        .ticket-number { background: #333; color: white; padding: 5px 15px; border-radius: 5px; }
        .ticket table { border-collapse: separate; border-spacing: 8px; width: 100%; flex-grow: 1; }
        .ticket td { border: 2px solid #333; width: 33.3%; height: 33.3%; text-align: center; font-size: 26px; font-weight: bold; background: #fafafa; border-radius: 8px; }
        
        @media print {
            #generator-section { background: white; padding: 0; }
            .gen-controls, #intro-screen, .main-container { display: none !important; }
            .page { margin: 0; padding: 0.5cm; box-shadow: none; page-break-after: always; }
            .ticket { page-break-inside: avoid; }
        }
    </style>
</head>
<body>

    <div id="intro-screen">
        <h1>–ò–°–¢–û–†–ò–ß–ï–°–ö–û –ë–ò–ù–ì–û</h1>
        <div class="author-name-intro">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª: –î–æ—á–∫–∞ –ö—é—á—É–∫–æ–≤–∞</div>
        <div class="instructions-intro">
            <strong>–£–ö–ê–ó–ê–ù–ò–Ø –ó–ê –ò–ì–†–ê–¢–ê:</strong><br><br>
            ‚Ä¢ –°–ª—É—à–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª–Ω–æ –∑–∞–≥–∞–¥–∫–∞—Ç–∞, –∫–æ—è—Ç–æ —â–µ —Å–µ –ø–æ—è–≤–∏ –Ω–∞ –µ–∫—Ä–∞–Ω–∞.<br>
            ‚Ä¢ –ê–∫–æ –∑–Ω–∞–µ—à –æ—Ç–≥–æ–≤–æ—Ä–∞ –∏ –≥–æ –æ—Ç–∫—Ä–∏–µ—à –≤ —Å–≤–æ—è –±–∏–ª–µ—Ç ‚Äì –∑–∞—á–µ—Ä–∫–Ω–∏ –≥–æ!<br>
            ‚Ä¢ –ö–æ–≥–∞—Ç–æ –∑–∞–ø—ä–ª–Ω–∏—à –≤—Å–∏—á–∫–∏ 9 –ø–æ–ª–µ—Ç–∞ –≤ –±–∏–ª–µ—Ç–∞ —Å–∏, –∏–∑–≤–∏–∫–∞–π —Å–∏–ª–Ω–æ <b>"–ë–ò–ù–ì–û"</b>!<br>
            ‚Ä¢ –ü–æ–±–µ–¥–∏—Ç–µ–ª—è—Ç —â–µ –ø–æ–ª—É—á–∏ –∑–≤–∞–Ω–∏–µ—Ç–æ "–ó–Ω–∞—Ç–µ–Ω –∏—Å—Ç–æ—Ä–∏–∫" –∏ —Å–ø–µ—Ü–∏–∞–ª–Ω–∞ –≥—Ä–∞–º–æ—Ç–∞.
        </div>
        <div class="btn-group">
            <button id="start-btn" onclick="startGame()">–°–¢–ê–†–¢</button>
            <button id="open-generator-btn" onclick="openGenerator()">–ü–†–ò–ù–¢–ò–†–ê–ô –ë–ò–õ–ï–¢–ò</button>
        </div>
    </div>

    <div id="generator-section">
        <div class="gen-controls">
            <h2 style="margin-top:0">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –±–∏–ª–µ—Ç–∏</h2>
            <button onclick="window.print()" style="padding: 10px 30px; background: #b21f1f; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–ü–ï–ß–ê–¢–ê–ô –í–°–ò–ß–ö–ò (PDF)</button>
            <button onclick="location.reload()" style="padding: 10px 30px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left:10px;">–ù–ê–ó–ê–î –ö–™–ú –ò–ì–†–ê–¢–ê</button>
        </div>
        <div id="tickets-container"></div>
    </div>

    <div id="check-screen">
        <h1 style="color: #fdbb2d;">–ü–†–û–í–ï–†–ö–ê –ù–ê –ü–û–ù–Ø–¢–ò–Ø–¢–ê</h1>
        <div id="check-log"></div>
        <button style="margin-top: 40px; padding: 15px 50px; background: #2ecc71; color: white; border: none; border-radius: 10px; font-size: 22px; cursor: pointer; font-weight: bold;" onclick="closeCheck()">–û–ë–†–ê–¢–ù–û –ö–™–ú –ò–ì–†–ê–¢–ê</button>
    </div>

    <div class="main-container" id="game-main">
        <div class="sphere-section">
            <div id="lotto-sphere"></div>
            <button id="check-btn" onclick="openCheck()">üîé –ü–†–û–í–ï–†–ö–ê –ó–ê –ë–ò–ù–ì–û</button>
        </div>

        <div class="answer-section">
            <h1 id="bingo-title">BINGO</h1>
            <div class="flip-card" id="card">
                <div class="card-face card-front">
                    <span style="font-size: 120px; opacity: 0.1;">?</span>
                </div>
                <div class="card-face card-back">
                    <div id="result-ball">0</div>
                    <p id="riddle-text"></p>
                </div>
            </div>
            <button id="draw-btn" onclick="drawBall()">–ò–ó–¢–ï–ì–õ–ò</button>
        </div>
    </div>

    <script>
        const riddles = [
            "–ü—ä—Ç—è—Ç, –ø–æ –∫–æ–π—Ç–æ —á–æ–≤–µ—á–µ—Å—Ç–≤–æ—Ç–æ –≤–µ—á–µ –µ –º–∏–Ω–∞–ª–æ.", "–î–µ—Å–µ—Ç —Ä–æ–∂–¥–µ–Ω–∏ –¥–Ω–∏, —Å—ä–±—Ä–∞–Ω–∏ –≤ –µ–¥–Ω–∞ –∫—É—Ç–∏–π–∫–∞.", "–ö–æ–≥–∞—Ç–æ —Å—Ç–æ —Å–≤–µ—â–∏—á–∫–∏ –Ω–µ —Å—Ç–∏–≥–∞—Ç –∑–∞ –≤—Ä–µ–º–µ—Ç–æ.", 
            "–û–≥—Ä–æ–º–µ–Ω —Å–∫–æ–∫ –≤—ä–≤ –≤—Ä–µ–º–µ—Ç–æ –æ—Ç —Ü–µ–ª–∏ 1000 –≥–æ–¥–∏–Ω–∏!", "–ö–æ–ª–∫–æ—Ç–æ –≤—Ä–µ–º–µ —Ç—Ä—è–±–≤–∞ –Ω–∞ –ó–µ–º—è—Ç–∞ –∑–∞ –æ–±–∏–∫–æ–ª–∫–∞ –Ω–∞ –°–ª—ä–Ω—Ü–µ—Ç–æ.", "–í–∞–∂–Ω–∞ —Å–ª—É—á–∫–∞ –≤ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞.",
            "–ü–æ–¥—Ä–µ–∂–¥–∞–º–µ —Å–ª—É—á–∫–∏—Ç–µ –µ–¥–Ω–∞ —Å–ª–µ–¥ –¥—Ä—É–≥–∞.", "–ö–Ω–∏–≥–∞, –≤ –∫–æ—è—Ç–æ —Å–∞ –∑–∞–ø–∏—Å–∞–Ω–∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ç–∞ –Ω–∞ —Ö–æ—Ä–∞—Ç–∞.", "–ú–∞–π—Å—Ç–æ—Ä–∏—Ç–µ –Ω–∞ –∑–ª–∞—Ç–æ—Ç–æ.",
            "–ë–∞—â–∞—Ç–∞ —Å—ä—Å —Å–Ω–æ–ø–∞ –ø—Ä—ä—á–∫–∏.", "–ö–æ–Ω–Ω–∏–∫—ä—Ç, –∫–æ–π—Ç–æ –∫–∞–∑–∞: ‚Äû–¢—É–∫ —â–µ –±—ä–¥–µ –ë—ä–ª–≥–∞—Ä–∏—è!‚Äú", "–†–æ–∂–¥–µ–Ω–∞—Ç–∞ –¥–∞—Ç–∞ –Ω–∞ –¥—ä—Ä–∂–∞–≤–∞—Ç–∞ –Ω–∏.",
            "–ü—ä—Ç–µ—á–∫–∞, –ø–æ –∫–æ—è—Ç–æ ‚Äû—Ä–∞–∑—Ö–æ–∂–¥–∞–º–µ‚Äú –¥–∞—Ç–∏—Ç–µ.", "–í–µ–∫—ä—Ç, –≤ –∫–æ–π—Ç–æ —Å–µ —Ä–æ–¥–∏–ª–∞ –ê—Å–ø–∞—Ä—É—Ö–æ–≤–∞ –ë—ä–ª–≥–∞—Ä–∏—è.", "–í—Ä–µ–º–µ—Ç–æ –Ω–∞ —Å–ª–∞–≤–Ω–∏—Ç–µ –∑–∞–∫–æ–Ω–∏ –Ω–∞ —Ö–∞–Ω –ö—Ä—É–º.",
            "–°–ª–µ–¥–∏—Ç–µ –æ—Ç –º–∏–Ω–∞–ª–æ—Ç–æ (–º–æ–Ω–µ—Ç–∏, –ø–∏—Å–º–∞).", "–î–µ—Ç–µ–∫—Ç–∏–≤ —Å —á–µ—Ç–∫–∞ –∏ –ª–æ–ø–∞—Ç–∫–∞.", "–ö—ä—â–∞ –∑–∞ —Å–ø–æ–º–µ–Ω–∏ –∏ –ø—Ä–µ–¥–º–µ—Ç–∏.",
            "–ù–∞—à–µ—Ç–æ –≥–æ–ª—è–º–æ —Å–µ–º–µ–π—Å—Ç–≤–æ —Å—ä—Å –∑–∞–∫–æ–Ω–∏.", "–ì—Ä–∞–¥—ä—Ç, –æ—Ç –∫–æ–π—Ç–æ —Å–µ —É–ø—Ä–∞–≤–ª—è–≤–∞ –¥—ä—Ä–∂–∞–≤–∞—Ç–∞.", "–ü—ä—Ä–≤–∞—Ç–∞ —Å—Ç–æ–ª–∏—Ü–∞.",
            "–•—Ä–∞–±—Ä–∏—Ç–µ –µ–∑–¥–∞—á–∏ - —Å–∏–ª–∞—Ç–∞ –Ω–∞ –±—ä–ª–≥–∞—Ä–∏—Ç–µ.", "–¶–≤–µ—Ç–Ω–∏ –∫–∞—Ä—Ç–∏–Ω–∏ –≤—ä—Ä—Ö—É —Å—Ç–µ–Ω–∏—Ç–µ.", "–ö–∞–º–µ–Ω–Ω–∞ —Å—Ç–∞—Ç—É—è –∏–ª–∏ –ø–ª–æ—á–∞ –∑–∞ –≥–µ—Ä–æ—è."
        ];

        const terms = [
            "–ò—Å—Ç–æ—Ä–∏—è", "–î–µ—Å–µ—Ç–∏–ª–µ—Ç–∏–µ", "–í–µ–∫", "–•–∏–ª—è–¥–æ–ª–µ—Ç–∏–µ", "–ì–æ–¥–∏–Ω–∞", "–°—ä–±–∏—Ç–∏–µ", "–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è", "–ò–∑–≤–æ—Ä–∏", "–¢—Ä–∞–∫–∏", 
            "–•–∞–Ω –ö—É–±—Ä–∞—Ç", "–•–∞–Ω –ê—Å–ø–∞—Ä—É—Ö", "681 –≥–æ–¥–∏–Ω–∞", "–õ–∏–Ω–∏—è –Ω–∞ –≤—Ä–µ–º–µ—Ç–æ", "VII –≤–µ–∫", "–•–∞–Ω –ö—Ä—É–º", "–ù–∞—Ö–æ–¥–∫–∏", 
            "–ê—Ä—Ö–µ–æ–ª–æ–≥", "–ú—É–∑–µ–π", "–î—ä—Ä–∂–∞–≤–∞", "–°—Ç–æ–ª–∏—Ü–∞", "–ü–ª–∏—Å–∫–∞", "–ö–æ–Ω–Ω–∏—Ü–∞", "–°—Ç–µ–Ω–æ–ø–∏—Å–∏", "–ü–∞–º–µ—Ç–Ω–∏–∫"
        ];

        let pool = Array.from(Array(riddles.length).keys());
        let drawnHistory = [];
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function startGame() {
            document.getElementById('intro-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('intro-screen').style.display = 'none';
                document.getElementById('game-main').style.display = 'flex';
            }, 500);
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function openGenerator() {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('generator-section').style.display = 'block';
            generateTickets(20);
        }

        function generateTickets(count) {
            const container = document.getElementById('tickets-container');
            container.innerHTML = '';
            let currentPage;
            for (let i = 1; i <= count; i++) {
                if ((i - 1) % 2 === 0) {
                    currentPage = document.createElement('div');
                    currentPage.className = 'page';
                    container.appendChild(currentPage);
                }
                const selected = [...terms].sort(() => 0.5 - Math.random()).slice(0, 9);
                let ticketHtml = `<div class="ticket"><div class="ticket-header"><h1 class="ticket-title">BINGO</h1><div class="ticket-number">‚Ññ${i}</div></div><table>`;
                for (let row = 0; row < 3; row++) {
                    ticketHtml += "<tr>";
                    for (let col = 0; col < 3; col++) { ticketHtml += `<td>${selected[row * 3 + col]}</td>`; }
                    ticketHtml += "</tr>";
                }
                ticketHtml += `</table><div style="margin-top:10px; font-style:italic; font-size:14px; color:#666">–î. –ö—é—á—É–∫–æ–≤–∞ - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ –ë–∏–Ω–≥–æ</div></div>`;
                currentPage.innerHTML += ticketHtml;
            }
        }

        function playSound(f, d) {
            const o = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            o.frequency.value = f;
            g.gain.setValueAtTime(0.05, audioCtx.currentTime);
            o.start(); o.stop(audioCtx.currentTime + d);
        }

        const sphere = document.getElementById('lotto-sphere');
        const balls = [];
        for (let i = 0; i < riddles.length; i++) {
            const el = document.createElement('div');
            el.className = 'ball'; el.innerText = i + 1;
            el.style.left = Math.random() * 420 + 'px';
            el.style.top = Math.random() * 420 + 'px';
            sphere.appendChild(el);
            balls.push({ el, x: Math.random() * 2 - 1, y: Math.random() * 2 - 1, speed: 1.5 });
        }

        function update() {
            balls.forEach(b => {
                let x = parseFloat(b.el.style.left);
                let y = parseFloat(b.el.style.top);
                if (x <= 0 || x >= 428) b.x *= -1;
                if (y <= 0 || y >= 428) b.y *= -1;
                b.el.style.left = (x + b.x * b.speed) + 'px';
                b.el.style.top = (y + b.y * b.speed) + 'px';
            });
            requestAnimationFrame(update);
        }
        update();

        function drawBall() {
            if (pool.length === 0) return;
            const btn = document.getElementById('draw-btn');
            btn.disabled = true;
            document.getElementById('card').classList.remove('is-flipped');
            balls.forEach(b => b.speed = 18);
            const mixSound = setInterval(() => playSound(150 + Math.random()*250, 0.05), 80);
            setTimeout(() => {
                clearInterval(mixSound);
                balls.forEach(b => b.speed = 1.5);
                playSound(440, 0.2);
                const rIdx = pool.splice(Math.floor(Math.random()*pool.length), 1)[0];
                const ballEl = balls.find(b => b.el.innerText == (rIdx+1));
                if(ballEl) ballEl.el.style.display = 'none';
                drawnHistory.push({ num: rIdx + 1, term: terms[rIdx] });
                document.getElementById('result-ball').innerText = rIdx + 1;
                document.getElementById('riddle-text').innerText = riddles[rIdx];
                document.getElementById('card').classList.add('is-flipped');
                btn.disabled = false;
            }, 1200);
        }

        function openCheck() {
            const log = document.getElementById('check-log');
            log.innerHTML = '';
            drawnHistory.forEach(item => {
                const div = document.createElement('div');
                div.className = 'log-item';
                div.innerHTML = `<b>‚Ññ${item.num}</b> ‚Äî ${item.term}`;
                log.appendChild(div);
            });
            document.getElementById('check-screen').style.display = 'flex';
        }
        function closeCheck() { document.getElementById('check-screen').style.display = 'none'; }
    </script>
</body>
</html>